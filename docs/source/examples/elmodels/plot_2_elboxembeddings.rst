
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/elmodels/plot_2_elboxembeddings.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_examples_elmodels_plot_2_elboxembeddings.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_elmodels_plot_2_elboxembeddings.py:


ELBoxEmbeddings
===========================

This example is based on the paper `Description Logic EL++ Embeddings with Intersectional Closure <https://arxiv.org/abs/2202.14018v1>`_. This paper is based on the idea of :doc:`/examples/elmodels/plot_1_elembeddings`, but in this work the main point is to solve the *intersectional closure* problem.

In the case of :doc:`/examples/elmodels/plot_1_elembeddings`, the geometric objects representing ontology classes are :math:`n`-dimensional balls. One of the normal forms in EL is:

.. math::
   C_1 \sqcap C_2 \sqsubseteq D

As we can see, there is an intersection operation :math:`C_1 \sqcap C_2`. Computing this intersection using balls is not a closed operations because the region contained in the intersection of two balls is not a ball. To solve that issue, this paper proposes the idea of changing the geometric objects to boxes, for which the intersection operation has the closure property.

.. GENERATED FROM PYTHON SOURCE LINES 24-27

This example is quite similar to the one found in :doc:`/examples/elmodels/plot_1_elembeddings`.
There might be slight changes in the training part but the most important changes are in the
definition of loss functions definition of the loss functions for each normal form.

.. GENERATED FROM PYTHON SOURCE LINES 27-34

.. code-block:: default



    import mowl
    mowl.init_jvm("10g")
    import torch as th









.. GENERATED FROM PYTHON SOURCE LINES 35-40

ELBoxEmbeddings (PyTorch) module
---------------------------------

ELBoxEmbeddings defines a geometric modelling for all the GCIs in the EL language.
The implementation of ELEmbeddings module can be found at :class:`mowl.nn.el.elem.module.ELBoxModule`

.. GENERATED FROM PYTHON SOURCE LINES 43-55

ELBoxEmbeddings model
----------------------

The module :class:`mowl.nn.el.elem.module.ELBoxModule` is used in the :class:`mowl.models.elboxembeddings.model.ELBoxEmbeddings`.
In the use case of this example, we will test over a biological problem, which is
protein-protein interactions. Given two proteins :math:`p_1,p_2`, the phenomenon
":math:`p_1` interacts with :math:`p_2`" is encoded using GCI 2 as:

.. math::
   p_1 \sqsubseteq interacts\_with. p_2

For that, we can use the class :class:`mowl.models.elembeddings.examples.model_ppi.ELBoxPPI` mode, which uses the :class:`mowl.datasets.builtin.PPIYeastSlimDataset` dataset.

.. GENERATED FROM PYTHON SOURCE LINES 60-62

Training the model
-------------------

.. GENERATED FROM PYTHON SOURCE LINES 62-83

.. code-block:: default



    from mowl.datasets.builtin import PPIYeastSlimDataset
    from mowl.models.elboxembeddings.examples.model_ppi import ELBoxPPI

    dataset = PPIYeastSlimDataset()

    model = ELBoxPPI(dataset,
                     embed_dim=30,
                     margin=-0.05,
                     reg_norm=1,
                     learning_rate=0.001,
                     epochs=200,
                     batch_size=4096,
                     model_filepath=None,
                     device='cpu')

    model.train()







.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/200 [00:00<?, ?it/s]      0%|          | 1/200 [00:05<17:05,  5.15s/it]      1%|1         | 2/200 [00:10<16:30,  5.00s/it]      2%|1         | 3/200 [00:15<16:48,  5.12s/it]      2%|2         | 4/200 [00:20<16:29,  5.05s/it]      2%|2         | 5/200 [00:25<16:42,  5.14s/it]      3%|3         | 6/200 [00:30<16:25,  5.08s/it]      4%|3         | 7/200 [00:35<16:13,  5.05s/it]      4%|4         | 8/200 [00:40<16:24,  5.13s/it]      4%|4         | 9/200 [00:45<16:09,  5.08s/it]      5%|5         | 10/200 [00:50<15:59,  5.05s/it]      6%|5         | 11/200 [00:55<15:51,  5.03s/it]      6%|6         | 12/200 [01:00<15:41,  5.01s/it]      6%|6         | 13/200 [01:06<16:00,  5.14s/it]      7%|7         | 14/200 [01:11<15:45,  5.08s/it]      8%|7         | 15/200 [01:16<15:35,  5.06s/it]      8%|8         | 16/200 [01:21<15:26,  5.04s/it]      8%|8         | 17/200 [01:26<15:23,  5.04s/it]      9%|9         | 18/200 [01:31<15:14,  5.03s/it]     10%|9         | 19/200 [01:36<15:07,  5.01s/it]     10%|#         | 20/200 [01:41<15:11,  5.06s/it]     10%|#         | 21/200 [01:46<15:15,  5.11s/it]     11%|#1        | 22/200 [01:51<15:01,  5.07s/it]     12%|#1        | 23/200 [01:56<14:51,  5.04s/it]     12%|#2        | 24/200 [02:01<14:42,  5.01s/it]     12%|#2        | 25/200 [02:06<14:35,  5.00s/it]     13%|#3        | 26/200 [02:11<14:29,  5.00s/it]     14%|#3        | 27/200 [02:16<14:22,  4.98s/it]     14%|#4        | 28/200 [02:21<14:15,  4.97s/it]     14%|#4        | 29/200 [02:26<14:17,  5.02s/it]     15%|#5        | 30/200 [02:31<14:08,  4.99s/it]     16%|#5        | 31/200 [02:36<14:03,  4.99s/it]     16%|#6        | 32/200 [02:41<13:56,  4.98s/it]     16%|#6        | 33/200 [02:46<13:51,  4.98s/it]     17%|#7        | 34/200 [02:51<13:44,  4.97s/it]     18%|#7        | 35/200 [02:56<13:39,  4.97s/it]     18%|#8        | 36/200 [03:01<13:35,  4.98s/it]     18%|#8        | 37/200 [03:06<13:30,  4.97s/it]     19%|#9        | 38/200 [03:11<13:26,  4.98s/it]     20%|#9        | 39/200 [03:16<13:20,  4.97s/it]     20%|##        | 40/200 [03:21<13:16,  4.98s/it]     20%|##        | 41/200 [03:26<13:12,  4.98s/it]     21%|##1       | 42/200 [03:31<13:27,  5.11s/it]     22%|##1       | 43/200 [03:36<13:37,  5.20s/it]     22%|##2       | 44/200 [03:41<13:21,  5.14s/it]     22%|##2       | 45/200 [03:46<13:09,  5.09s/it]     23%|##3       | 46/200 [03:51<12:59,  5.06s/it]     24%|##3       | 47/200 [03:56<12:52,  5.05s/it]     24%|##4       | 48/200 [04:01<12:45,  5.04s/it]     24%|##4       | 49/200 [04:06<12:38,  5.02s/it]     25%|##5       | 50/200 [04:11<12:31,  5.01s/it]     26%|##5       | 51/200 [04:16<12:24,  4.99s/it]     26%|##6       | 52/200 [04:21<12:17,  4.99s/it]     26%|##6       | 53/200 [04:26<12:12,  4.98s/it]     27%|##7       | 54/200 [04:31<12:06,  4.98s/it]     28%|##7       | 55/200 [04:36<12:14,  5.06s/it]     28%|##8       | 56/200 [04:41<12:05,  5.04s/it]     28%|##8       | 57/200 [04:46<11:56,  5.01s/it]     29%|##9       | 58/200 [04:51<11:49,  5.00s/it]     30%|##9       | 59/200 [04:56<11:46,  5.01s/it]     30%|###       | 60/200 [05:01<11:43,  5.02s/it]     30%|###       | 61/200 [05:06<11:36,  5.01s/it]     31%|###1      | 62/200 [05:12<11:34,  5.04s/it]     32%|###1      | 63/200 [05:16<11:26,  5.01s/it]     32%|###2      | 64/200 [05:21<11:19,  5.00s/it]     32%|###2      | 65/200 [05:26<11:14,  4.99s/it]     33%|###3      | 66/200 [05:31<11:08,  4.99s/it]     34%|###3      | 67/200 [05:37<11:11,  5.05s/it]     34%|###4      | 68/200 [05:42<11:06,  5.05s/it]     34%|###4      | 69/200 [05:47<10:58,  5.02s/it]     35%|###5      | 70/200 [05:52<10:51,  5.01s/it]     36%|###5      | 71/200 [05:57<10:44,  5.00s/it]     36%|###6      | 72/200 [06:02<10:38,  4.99s/it]     36%|###6      | 73/200 [06:07<10:32,  4.98s/it]     37%|###7      | 74/200 [06:11<10:28,  4.99s/it]     38%|###7      | 75/200 [06:16<10:22,  4.98s/it]     38%|###8      | 76/200 [06:21<10:17,  4.98s/it]     38%|###8      | 77/200 [06:26<10:13,  4.99s/it]     39%|###9      | 78/200 [06:31<10:09,  5.00s/it]     40%|###9      | 79/200 [06:36<10:03,  4.99s/it]     40%|####      | 80/200 [06:41<09:58,  4.99s/it]     40%|####      | 81/200 [06:47<10:10,  5.13s/it]     41%|####1     | 82/200 [06:52<09:59,  5.08s/it]     42%|####1     | 83/200 [06:57<10:07,  5.19s/it]     42%|####2     | 84/200 [07:02<09:53,  5.12s/it]     42%|####2     | 85/200 [07:07<09:43,  5.08s/it]     43%|####3     | 86/200 [07:13<09:46,  5.15s/it]     44%|####3     | 87/200 [07:18<09:40,  5.14s/it]     44%|####4     | 88/200 [07:23<09:32,  5.11s/it]     44%|####4     | 89/200 [07:28<09:24,  5.09s/it]     45%|####5     | 90/200 [07:33<09:16,  5.06s/it]     46%|####5     | 91/200 [07:38<09:19,  5.13s/it]     46%|####6     | 92/200 [07:43<09:08,  5.08s/it]     46%|####6     | 93/200 [07:48<09:00,  5.05s/it]     47%|####6     | 94/200 [07:53<08:53,  5.03s/it]     48%|####7     | 95/200 [07:58<08:59,  5.13s/it]     48%|####8     | 96/200 [08:04<08:58,  5.18s/it]     48%|####8     | 97/200 [08:09<08:52,  5.17s/it]     49%|####9     | 98/200 [08:14<08:42,  5.12s/it]     50%|####9     | 99/200 [08:19<08:32,  5.08s/it]Saving model..
    Epoch 99: Train loss: 2.1673591136932373 Valid loss: 1.6152937412261963
     50%|#####     | 100/200 [08:24<08:24,  5.04s/it]     50%|#####     | 101/200 [08:29<08:17,  5.03s/it]     51%|#####1    | 102/200 [08:34<08:11,  5.02s/it]     52%|#####1    | 103/200 [08:39<08:05,  5.01s/it]     52%|#####2    | 104/200 [08:44<07:59,  5.00s/it]     52%|#####2    | 105/200 [08:49<07:54,  4.99s/it]     53%|#####3    | 106/200 [08:54<07:49,  4.99s/it]     54%|#####3    | 107/200 [08:59<07:43,  4.99s/it]     54%|#####4    | 108/200 [09:04<07:39,  5.00s/it]     55%|#####4    | 109/200 [09:09<07:34,  5.00s/it]     55%|#####5    | 110/200 [09:14<07:29,  5.00s/it]     56%|#####5    | 111/200 [09:19<07:32,  5.08s/it]     56%|#####6    | 112/200 [09:24<07:25,  5.06s/it]     56%|#####6    | 113/200 [09:29<07:18,  5.05s/it]     57%|#####6    | 114/200 [09:34<07:11,  5.02s/it]     57%|#####7    | 115/200 [09:39<07:05,  5.01s/it]     58%|#####8    | 116/200 [09:44<07:05,  5.07s/it]     58%|#####8    | 117/200 [09:49<07:01,  5.08s/it]     59%|#####8    | 118/200 [09:54<06:54,  5.05s/it]     60%|#####9    | 119/200 [09:59<06:47,  5.03s/it]     60%|######    | 120/200 [10:04<06:42,  5.03s/it]     60%|######    | 121/200 [10:10<06:48,  5.17s/it]     61%|######1   | 122/200 [10:15<06:38,  5.11s/it]     62%|######1   | 123/200 [10:20<06:32,  5.10s/it]     62%|######2   | 124/200 [10:25<06:25,  5.08s/it]     62%|######2   | 125/200 [10:30<06:19,  5.05s/it]     63%|######3   | 126/200 [10:35<06:16,  5.09s/it]     64%|######3   | 127/200 [10:40<06:09,  5.06s/it]     64%|######4   | 128/200 [10:45<06:12,  5.18s/it]     64%|######4   | 129/200 [10:50<06:04,  5.13s/it]     65%|######5   | 130/200 [10:56<06:05,  5.23s/it]     66%|######5   | 131/200 [11:01<05:56,  5.16s/it]     66%|######6   | 132/200 [11:06<05:52,  5.18s/it]     66%|######6   | 133/200 [11:11<05:43,  5.12s/it]     67%|######7   | 134/200 [11:16<05:35,  5.08s/it]     68%|######7   | 135/200 [11:21<05:28,  5.05s/it]     68%|######8   | 136/200 [11:26<05:26,  5.10s/it]     68%|######8   | 137/200 [11:31<05:19,  5.08s/it]     69%|######9   | 138/200 [11:36<05:13,  5.05s/it]     70%|######9   | 139/200 [11:41<05:07,  5.03s/it]     70%|#######   | 140/200 [11:46<05:00,  5.01s/it]     70%|#######   | 141/200 [11:51<04:56,  5.02s/it]     71%|#######1  | 142/200 [11:56<04:50,  5.01s/it]     72%|#######1  | 143/200 [12:01<04:45,  5.01s/it]     72%|#######2  | 144/200 [12:07<04:48,  5.15s/it]     72%|#######2  | 145/200 [12:12<04:40,  5.11s/it]     73%|#######3  | 146/200 [12:17<04:33,  5.07s/it]     74%|#######3  | 147/200 [12:22<04:27,  5.05s/it]     74%|#######4  | 148/200 [12:27<04:25,  5.10s/it]     74%|#######4  | 149/200 [12:32<04:19,  5.10s/it]     75%|#######5  | 150/200 [12:37<04:13,  5.07s/it]     76%|#######5  | 151/200 [12:42<04:07,  5.05s/it]     76%|#######6  | 152/200 [12:47<04:01,  5.03s/it]     76%|#######6  | 153/200 [12:52<03:56,  5.02s/it]     77%|#######7  | 154/200 [12:57<03:50,  5.01s/it]     78%|#######7  | 155/200 [13:02<03:45,  5.00s/it]     78%|#######8  | 156/200 [13:07<03:41,  5.02s/it]     78%|#######8  | 157/200 [13:12<03:36,  5.04s/it]     79%|#######9  | 158/200 [13:17<03:31,  5.03s/it]     80%|#######9  | 159/200 [13:22<03:26,  5.03s/it]     80%|########  | 160/200 [13:27<03:20,  5.02s/it]     80%|########  | 161/200 [13:33<03:20,  5.15s/it]     81%|########1 | 162/200 [13:38<03:19,  5.24s/it]     82%|########1 | 163/200 [13:43<03:14,  5.25s/it]     82%|########2 | 164/200 [13:49<03:11,  5.31s/it]     82%|########2 | 165/200 [13:54<03:03,  5.23s/it]     83%|########2 | 166/200 [13:59<02:55,  5.16s/it]     84%|########3 | 167/200 [14:04<02:50,  5.18s/it]     84%|########4 | 168/200 [14:09<02:43,  5.12s/it]     84%|########4 | 169/200 [14:14<02:37,  5.09s/it]     85%|########5 | 170/200 [14:19<02:32,  5.07s/it]     86%|########5 | 171/200 [14:24<02:26,  5.06s/it]     86%|########6 | 172/200 [14:29<02:21,  5.06s/it]     86%|########6 | 173/200 [14:35<02:19,  5.17s/it]     87%|########7 | 174/200 [14:40<02:13,  5.12s/it]     88%|########7 | 175/200 [14:45<02:07,  5.09s/it]     88%|########8 | 176/200 [14:50<02:01,  5.06s/it]     88%|########8 | 177/200 [14:55<01:56,  5.04s/it]     89%|########9 | 178/200 [15:00<01:50,  5.03s/it]     90%|########9 | 179/200 [15:05<01:48,  5.15s/it]     90%|######### | 180/200 [15:10<01:42,  5.11s/it]     90%|######### | 181/200 [15:15<01:36,  5.09s/it]     91%|#########1| 182/200 [15:20<01:30,  5.05s/it]     92%|#########1| 183/200 [15:25<01:25,  5.06s/it]     92%|#########2| 184/200 [15:30<01:20,  5.04s/it]     92%|#########2| 185/200 [15:35<01:15,  5.02s/it]     93%|#########3| 186/200 [15:40<01:11,  5.10s/it]     94%|#########3| 187/200 [15:46<01:07,  5.17s/it]     94%|#########3| 188/200 [15:51<01:01,  5.10s/it]     94%|#########4| 189/200 [15:56<00:57,  5.21s/it]     95%|#########5| 190/200 [16:02<00:52,  5.29s/it]     96%|#########5| 191/200 [16:07<00:46,  5.20s/it]     96%|#########6| 192/200 [16:12<00:41,  5.15s/it]     96%|#########6| 193/200 [16:17<00:35,  5.10s/it]     97%|#########7| 194/200 [16:22<00:30,  5.12s/it]     98%|#########7| 195/200 [16:27<00:25,  5.09s/it]     98%|#########8| 196/200 [16:32<00:20,  5.12s/it]     98%|#########8| 197/200 [16:37<00:15,  5.09s/it]     99%|#########9| 198/200 [16:42<00:10,  5.06s/it]    100%|#########9| 199/200 [16:47<00:05,  5.04s/it]Saving model..
    Epoch 199: Train loss: 1.3585336208343506 Valid loss: 1.1207185983657837
    100%|##########| 200/200 [16:52<00:00,  5.02s/it]    100%|##########| 200/200 [16:52<00:00,  5.06s/it]

    1



.. GENERATED FROM PYTHON SOURCE LINES 84-89

Evaluating the model
----------------------

Now, it is time to evaluate embeddings. For this, we use the
:class:`ModelRankBasedEvaluator <mowl.evaluation.ModelRankBasedEvaluator>` class.

.. GENERATED FROM PYTHON SOURCE LINES 89-102

.. code-block:: default



    from mowl.evaluation.rank_based import ModelRankBasedEvaluator

    with th.no_grad():                                                                        
        model.load_best_model()                                                               
        evaluator = ModelRankBasedEvaluator(                                                  
            model,                                                                            
            device = "cpu",
            eval_method = model.eval_method,
        )                                                                                         
                                                                                                  
        evaluator.evaluate(show=True)




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/12040 [00:00<?, ?it/s]      0%|          | 17/12040 [00:00<01:11, 169.09it/s]      0%|          | 38/12040 [00:00<01:02, 191.31it/s]      0%|          | 59/12040 [00:00<01:00, 197.86it/s]      1%|          | 79/12040 [00:00<01:31, 130.92it/s]      1%|          | 101/12040 [00:00<01:17, 153.23it/s]      1%|1         | 123/12040 [00:00<01:09, 170.42it/s]      1%|1         | 142/12040 [00:00<01:31, 130.02it/s]      1%|1         | 164/12040 [00:01<01:19, 149.71it/s]      2%|1         | 186/12040 [00:01<01:11, 165.39it/s]      2%|1         | 205/12040 [00:01<01:30, 130.37it/s]      2%|1         | 227/12040 [00:01<01:19, 149.14it/s]      2%|2         | 249/12040 [00:01<01:11, 165.24it/s]      2%|2         | 271/12040 [00:01<01:05, 178.58it/s]      2%|2         | 291/12040 [00:01<01:25, 137.71it/s]      3%|2         | 313/12040 [00:02<01:15, 155.15it/s]      3%|2         | 335/12040 [00:02<01:08, 169.81it/s]      3%|2         | 357/12040 [00:02<01:04, 181.98it/s]      3%|3         | 377/12040 [00:02<01:24, 138.71it/s]      3%|3         | 399/12040 [00:02<01:14, 155.42it/s]      3%|3         | 421/12040 [00:02<01:08, 169.33it/s]      4%|3         | 440/12040 [00:02<01:27, 132.51it/s]      4%|3         | 461/12040 [00:03<01:17, 148.95it/s]      4%|4         | 482/12040 [00:03<01:10, 162.94it/s]      4%|4         | 501/12040 [00:03<01:29, 128.61it/s]      4%|4         | 523/12040 [00:03<01:18, 146.63it/s]      5%|4         | 545/12040 [00:03<01:10, 162.26it/s]      5%|4         | 567/12040 [00:03<01:05, 175.15it/s]      5%|4         | 589/12040 [00:03<01:23, 137.60it/s]      5%|5         | 611/12040 [00:03<01:14, 153.88it/s]      5%|5         | 633/12040 [00:04<01:07, 168.01it/s]      5%|5         | 655/12040 [00:04<01:03, 179.28it/s]      6%|5         | 675/12040 [00:04<01:22, 138.08it/s]      6%|5         | 697/12040 [00:04<01:13, 154.46it/s]      6%|5         | 719/12040 [00:04<01:07, 168.50it/s]      6%|6         | 738/12040 [00:04<01:26, 130.60it/s]      6%|6         | 759/12040 [00:04<01:16, 147.14it/s]      6%|6         | 780/12040 [00:05<01:09, 161.09it/s]      7%|6         | 799/12040 [00:05<01:27, 127.80it/s]      7%|6         | 821/12040 [00:05<01:16, 146.07it/s]      7%|6         | 842/12040 [00:05<01:09, 160.73it/s]      7%|7         | 864/12040 [00:05<01:04, 173.34it/s]      7%|7         | 886/12040 [00:05<01:00, 183.29it/s]      8%|7         | 906/12040 [00:05<01:20, 138.55it/s]      8%|7         | 927/12040 [00:06<01:12, 154.02it/s]      8%|7         | 948/12040 [00:06<01:06, 167.11it/s]      8%|8         | 968/12040 [00:06<01:24, 131.69it/s]      8%|8         | 989/12040 [00:06<01:15, 147.20it/s]      8%|8         | 1010/12040 [00:06<01:08, 160.47it/s]      9%|8         | 1031/12040 [00:06<01:25, 129.05it/s]      9%|8         | 1052/12040 [00:06<01:15, 144.95it/s]      9%|8         | 1073/12040 [00:07<01:08, 158.97it/s]      9%|9         | 1091/12040 [00:07<01:26, 126.08it/s]      9%|9         | 1112/12040 [00:07<01:16, 143.66it/s]      9%|9         | 1134/12040 [00:07<01:08, 159.74it/s]     10%|9         | 1156/12040 [00:07<01:03, 172.73it/s]     10%|9         | 1177/12040 [00:07<00:59, 182.35it/s]     10%|9         | 1197/12040 [00:07<01:18, 138.00it/s]     10%|#         | 1218/12040 [00:07<01:10, 153.80it/s]     10%|#         | 1239/12040 [00:08<01:04, 167.16it/s]     10%|#         | 1261/12040 [00:08<01:00, 178.63it/s]     11%|#         | 1281/12040 [00:08<01:18, 136.97it/s]     11%|#         | 1303/12040 [00:08<01:09, 153.64it/s]     11%|#1        | 1325/12040 [00:08<01:03, 167.57it/s]     11%|#1        | 1344/12040 [00:08<01:21, 131.52it/s]     11%|#1        | 1366/12040 [00:08<01:11, 149.17it/s]     11%|#1        | 1384/12040 [00:09<01:27, 121.44it/s]     12%|#1        | 1405/12040 [00:09<01:16, 139.29it/s]     12%|#1        | 1427/12040 [00:09<01:07, 156.39it/s]     12%|#2        | 1447/12040 [00:09<01:03, 166.66it/s]     12%|#2        | 1468/12040 [00:09<00:59, 176.58it/s]     12%|#2        | 1488/12040 [00:09<01:17, 136.12it/s]     13%|#2        | 1510/12040 [00:09<01:08, 153.52it/s]     13%|#2        | 1532/12040 [00:10<01:02, 168.17it/s]     13%|#2        | 1553/12040 [00:10<00:58, 178.75it/s]     13%|#3        | 1573/12040 [00:10<01:16, 137.36it/s]     13%|#3        | 1595/12040 [00:10<01:07, 154.54it/s]     13%|#3        | 1617/12040 [00:10<01:01, 168.27it/s]     14%|#3        | 1636/12040 [00:10<01:19, 131.53it/s]     14%|#3        | 1657/12040 [00:10<01:10, 148.20it/s]     14%|#3        | 1678/12040 [00:10<01:03, 162.51it/s]     14%|#4        | 1697/12040 [00:11<01:20, 127.96it/s]     14%|#4        | 1718/12040 [00:11<01:10, 145.41it/s]     14%|#4        | 1740/12040 [00:11<01:03, 161.07it/s]     15%|#4        | 1761/12040 [00:11<00:59, 173.10it/s]     15%|#4        | 1782/12040 [00:11<00:56, 182.42it/s]     15%|#4        | 1802/12040 [00:11<01:14, 137.68it/s]     15%|#5        | 1823/12040 [00:11<01:06, 153.28it/s]     15%|#5        | 1844/12040 [00:12<01:01, 165.75it/s]     15%|#5        | 1865/12040 [00:12<01:17, 131.48it/s]     16%|#5        | 1886/12040 [00:12<01:08, 147.68it/s]     16%|#5        | 1907/12040 [00:12<01:02, 161.61it/s]     16%|#6        | 1928/12040 [00:12<01:17, 129.65it/s]     16%|#6        | 1949/12040 [00:12<01:09, 145.92it/s]     16%|#6        | 1970/12040 [00:12<01:02, 160.14it/s]     17%|#6        | 1989/12040 [00:13<01:19, 127.21it/s]     17%|#6        | 2010/12040 [00:13<01:09, 144.21it/s]     17%|#6        | 2031/12040 [00:13<01:03, 158.82it/s]     17%|#7        | 2052/12040 [00:13<00:59, 169.28it/s]     17%|#7        | 2071/12040 [00:13<00:58, 169.72it/s]     17%|#7        | 2090/12040 [00:13<01:15, 131.09it/s]     18%|#7        | 2111/12040 [00:13<01:07, 147.97it/s]     18%|#7        | 2132/12040 [00:14<01:01, 162.42it/s]     18%|#7        | 2153/12040 [00:14<00:56, 173.95it/s]     18%|#8        | 2172/12040 [00:14<01:14, 133.23it/s]     18%|#8        | 2193/12040 [00:14<01:05, 150.09it/s]     18%|#8        | 2214/12040 [00:14<00:59, 164.18it/s]     19%|#8        | 2233/12040 [00:14<01:15, 129.20it/s]     19%|#8        | 2254/12040 [00:14<01:06, 146.51it/s]     19%|#8        | 2275/12040 [00:14<01:00, 161.13it/s]     19%|#9        | 2294/12040 [00:15<01:16, 127.98it/s]     19%|#9        | 2316/12040 [00:15<01:06, 146.34it/s]     19%|#9        | 2338/12040 [00:15<00:59, 161.77it/s]     20%|#9        | 2360/12040 [00:15<00:55, 174.42it/s]     20%|#9        | 2382/12040 [00:15<00:52, 184.15it/s]     20%|#9        | 2402/12040 [00:15<01:09, 139.44it/s]     20%|##        | 2423/12040 [00:15<01:02, 154.97it/s]     20%|##        | 2444/12040 [00:16<00:57, 167.77it/s]     20%|##        | 2463/12040 [00:16<01:12, 131.47it/s]     21%|##        | 2484/12040 [00:16<01:04, 148.10it/s]     21%|##        | 2505/12040 [00:16<00:58, 162.65it/s]     21%|##        | 2526/12040 [00:16<01:13, 130.01it/s]     21%|##1       | 2547/12040 [00:16<01:04, 146.06it/s]     21%|##1       | 2568/12040 [00:16<00:59, 160.32it/s]     21%|##1       | 2587/12040 [00:17<01:14, 127.12it/s]     22%|##1       | 2608/12040 [00:17<01:05, 143.65it/s]     22%|##1       | 2629/12040 [00:17<00:59, 157.35it/s]     22%|##2       | 2650/12040 [00:17<00:55, 168.68it/s]     22%|##2       | 2671/12040 [00:17<00:52, 178.02it/s]     22%|##2       | 2691/12040 [00:17<01:08, 135.53it/s]     23%|##2       | 2713/12040 [00:17<01:01, 152.56it/s]     23%|##2       | 2734/12040 [00:17<00:56, 166.08it/s]     23%|##2       | 2755/12040 [00:18<00:52, 176.61it/s]     23%|##3       | 2775/12040 [00:18<01:08, 135.72it/s]     23%|##3       | 2796/12040 [00:18<01:00, 151.85it/s]     23%|##3       | 2817/12040 [00:18<00:55, 165.52it/s]     24%|##3       | 2836/12040 [00:18<01:11, 129.33it/s]     24%|##3       | 2856/12040 [00:18<01:03, 144.34it/s]     24%|##3       | 2877/12040 [00:18<00:57, 158.82it/s]     24%|##4       | 2895/12040 [00:19<01:13, 125.16it/s]     24%|##4       | 2915/12040 [00:19<01:05, 140.30it/s]     24%|##4       | 2937/12040 [00:19<00:57, 157.36it/s]     25%|##4       | 2959/12040 [00:19<00:53, 171.25it/s]     25%|##4       | 2981/12040 [00:19<01:07, 135.18it/s]     25%|##4       | 3001/12040 [00:19<01:00, 149.05it/s]     25%|##5       | 3022/12040 [00:19<00:55, 162.39it/s]     25%|##5       | 3042/12040 [00:20<00:52, 170.26it/s]     25%|##5       | 3061/12040 [00:20<01:07, 132.10it/s]     26%|##5       | 3082/12040 [00:20<01:00, 148.53it/s]     26%|##5       | 3103/12040 [00:20<00:54, 163.04it/s]     26%|##5       | 3124/12040 [00:20<01:08, 130.06it/s]     26%|##6       | 3145/12040 [00:20<01:00, 146.12it/s]     26%|##6       | 3166/12040 [00:20<00:55, 160.17it/s]     26%|##6       | 3185/12040 [00:21<01:09, 127.56it/s]     27%|##6       | 3205/12040 [00:21<01:02, 141.50it/s]     27%|##6       | 3225/12040 [00:21<00:57, 153.44it/s]     27%|##6       | 3247/12040 [00:21<00:52, 167.88it/s]     27%|##7       | 3269/12040 [00:21<00:48, 179.36it/s]     27%|##7       | 3289/12040 [00:21<01:04, 136.71it/s]     27%|##7       | 3310/12040 [00:21<00:57, 152.70it/s]     28%|##7       | 3331/12040 [00:21<00:52, 165.97it/s]     28%|##7       | 3352/12040 [00:22<00:49, 176.43it/s]     28%|##8       | 3372/12040 [00:22<01:04, 135.28it/s]     28%|##8       | 3393/12040 [00:22<00:57, 151.54it/s]     28%|##8       | 3415/12040 [00:22<00:51, 165.91it/s]     29%|##8       | 3434/12040 [00:22<01:05, 130.50it/s]     29%|##8       | 3455/12040 [00:22<00:58, 146.86it/s]     29%|##8       | 3476/12040 [00:23<01:09, 122.59it/s]     29%|##9       | 3497/12040 [00:23<01:01, 139.81it/s]     29%|##9       | 3518/12040 [00:23<00:54, 155.43it/s]     29%|##9       | 3539/12040 [00:23<00:50, 167.69it/s]     30%|##9       | 3561/12040 [00:23<00:47, 178.92it/s]     30%|##9       | 3581/12040 [00:23<01:01, 136.77it/s]     30%|##9       | 3602/12040 [00:23<00:55, 152.49it/s]     30%|###       | 3620/12040 [00:23<00:53, 156.26it/s]     30%|###       | 3640/12040 [00:24<00:50, 165.77it/s]     30%|###       | 3659/12040 [00:24<01:05, 128.30it/s]     31%|###       | 3678/12040 [00:24<00:59, 141.65it/s]     31%|###       | 3699/12040 [00:24<00:53, 156.23it/s]     31%|###       | 3720/12040 [00:24<00:49, 168.62it/s]     31%|###1      | 3739/12040 [00:24<01:03, 130.15it/s]     31%|###1      | 3760/12040 [00:24<00:56, 146.99it/s]     31%|###1      | 3777/12040 [00:25<01:09, 118.43it/s]     32%|###1      | 3798/12040 [00:25<01:00, 137.35it/s]     32%|###1      | 3819/12040 [00:25<00:53, 153.90it/s]     32%|###1      | 3840/12040 [00:25<00:48, 167.55it/s]     32%|###2      | 3861/12040 [00:25<00:45, 178.41it/s]     32%|###2      | 3881/12040 [00:25<01:00, 135.87it/s]     32%|###2      | 3902/12040 [00:25<00:53, 151.87it/s]     33%|###2      | 3923/12040 [00:25<00:49, 165.54it/s]     33%|###2      | 3944/12040 [00:26<00:45, 176.39it/s]     33%|###2      | 3964/12040 [00:26<00:59, 135.47it/s]     33%|###3      | 3985/12040 [00:26<00:53, 151.38it/s]     33%|###3      | 4006/12040 [00:26<00:48, 164.93it/s]     33%|###3      | 4025/12040 [00:26<01:01, 129.56it/s]     34%|###3      | 4046/12040 [00:26<00:54, 146.24it/s]     34%|###3      | 4067/12040 [00:26<00:49, 160.66it/s]     34%|###3      | 4086/12040 [00:27<01:02, 127.63it/s]     34%|###4      | 4108/12040 [00:27<00:54, 145.94it/s]     34%|###4      | 4129/12040 [00:27<00:49, 160.70it/s]     34%|###4      | 4151/12040 [00:27<00:45, 173.43it/s]     35%|###4      | 4172/12040 [00:27<00:43, 182.72it/s]     35%|###4      | 4192/12040 [00:27<00:56, 137.90it/s]     35%|###4      | 4213/12040 [00:27<00:51, 152.98it/s]     35%|###5      | 4234/12040 [00:28<00:47, 166.03it/s]     35%|###5      | 4255/12040 [00:28<00:44, 175.94it/s]     36%|###5      | 4275/12040 [00:28<00:57, 134.75it/s]     36%|###5      | 4296/12040 [00:28<00:51, 150.37it/s]     36%|###5      | 4317/12040 [00:28<00:47, 163.64it/s]     36%|###6      | 4336/12040 [00:28<01:00, 128.04it/s]     36%|###6      | 4357/12040 [00:28<00:53, 144.62it/s]     36%|###6      | 4374/12040 [00:29<01:05, 117.06it/s]     37%|###6      | 4395/12040 [00:29<00:56, 135.74it/s]     37%|###6      | 4416/12040 [00:29<00:50, 151.22it/s]     37%|###6      | 4438/12040 [00:29<00:45, 166.04it/s]     37%|###7      | 4459/12040 [00:29<00:42, 177.20it/s]     37%|###7      | 4479/12040 [00:29<00:55, 135.79it/s]     37%|###7      | 4500/12040 [00:29<00:49, 151.79it/s]     38%|###7      | 4521/12040 [00:29<00:45, 164.95it/s]     38%|###7      | 4542/12040 [00:30<00:42, 175.61it/s]     38%|###7      | 4562/12040 [00:30<00:55, 133.76it/s]     38%|###8      | 4582/12040 [00:30<00:50, 148.02it/s]     38%|###8      | 4603/12040 [00:30<00:46, 161.38it/s]     38%|###8      | 4622/12040 [00:30<00:59, 125.44it/s]     39%|###8      | 4642/12040 [00:30<00:52, 140.05it/s]     39%|###8      | 4663/12040 [00:30<00:47, 155.65it/s]     39%|###8      | 4681/12040 [00:31<00:59, 124.38it/s]     39%|###9      | 4702/12040 [00:31<00:51, 142.62it/s]     39%|###9      | 4723/12040 [00:31<00:46, 158.28it/s]     39%|###9      | 4745/12040 [00:31<00:42, 171.84it/s]     40%|###9      | 4766/12040 [00:31<00:40, 180.72it/s]     40%|###9      | 4786/12040 [00:31<00:53, 136.82it/s]     40%|###9      | 4807/12040 [00:31<00:47, 152.81it/s]     40%|####      | 4828/12040 [00:31<00:43, 166.50it/s]     40%|####      | 4849/12040 [00:32<00:40, 177.19it/s]     40%|####      | 4869/12040 [00:32<00:52, 135.43it/s]     41%|####      | 4890/12040 [00:32<00:47, 150.76it/s]     41%|####      | 4911/12040 [00:32<00:43, 163.47it/s]     41%|####      | 4930/12040 [00:32<00:55, 128.08it/s]     41%|####1     | 4951/12040 [00:32<00:48, 145.05it/s]     41%|####1     | 4971/12040 [00:33<00:58, 121.02it/s]     41%|####1     | 4992/12040 [00:33<00:50, 138.89it/s]     42%|####1     | 5013/12040 [00:33<00:45, 154.74it/s]     42%|####1     | 5034/12040 [00:33<00:41, 167.44it/s]     42%|####1     | 5056/12040 [00:33<00:39, 178.94it/s]     42%|####2     | 5076/12040 [00:33<00:51, 136.26it/s]     42%|####2     | 5097/12040 [00:33<00:46, 150.87it/s]     43%|####2     | 5118/12040 [00:33<00:42, 164.64it/s]     43%|####2     | 5139/12040 [00:34<00:39, 176.01it/s]     43%|####2     | 5159/12040 [00:34<00:50, 135.21it/s]     43%|####3     | 5180/12040 [00:34<00:45, 151.22it/s]     43%|####3     | 5201/12040 [00:34<00:41, 164.74it/s]     43%|####3     | 5220/12040 [00:34<00:52, 129.62it/s]     44%|####3     | 5241/12040 [00:34<00:46, 146.38it/s]     44%|####3     | 5262/12040 [00:34<00:42, 160.78it/s]     44%|####3     | 5281/12040 [00:35<00:53, 127.50it/s]     44%|####4     | 5302/12040 [00:35<00:46, 144.44it/s]     44%|####4     | 5322/12040 [00:35<00:42, 156.73it/s]     44%|####4     | 5343/12040 [00:35<00:39, 169.94it/s]     45%|####4     | 5364/12040 [00:35<00:37, 180.41it/s]     45%|####4     | 5384/12040 [00:35<00:48, 136.87it/s]     45%|####4     | 5405/12040 [00:35<00:43, 153.00it/s]     45%|####5     | 5427/12040 [00:35<00:39, 167.21it/s]     45%|####5     | 5448/12040 [00:36<00:37, 177.87it/s]     45%|####5     | 5468/12040 [00:36<00:48, 136.16it/s]     46%|####5     | 5489/12040 [00:36<00:43, 152.20it/s]     46%|####5     | 5510/12040 [00:36<00:39, 165.17it/s]     46%|####5     | 5529/12040 [00:36<00:50, 129.26it/s]     46%|####6     | 5550/12040 [00:36<00:44, 145.93it/s]     46%|####6     | 5569/12040 [00:37<00:53, 120.72it/s]     46%|####6     | 5590/12040 [00:37<00:46, 138.37it/s]     47%|####6     | 5611/12040 [00:37<00:41, 153.14it/s]     47%|####6     | 5632/12040 [00:37<00:38, 165.04it/s]     47%|####6     | 5652/12040 [00:37<00:36, 173.59it/s]     47%|####7     | 5672/12040 [00:37<00:47, 133.13it/s]     47%|####7     | 5693/12040 [00:37<00:42, 149.36it/s]     47%|####7     | 5714/12040 [00:37<00:38, 163.60it/s]     48%|####7     | 5735/12040 [00:38<00:36, 175.08it/s]     48%|####7     | 5755/12040 [00:38<00:46, 134.85it/s]     48%|####7     | 5777/12040 [00:38<00:41, 152.15it/s]     48%|####8     | 5798/12040 [00:38<00:37, 165.59it/s]     48%|####8     | 5817/12040 [00:38<00:47, 130.27it/s]     48%|####8     | 5838/12040 [00:38<00:42, 147.02it/s]     49%|####8     | 5858/12040 [00:38<00:38, 158.89it/s]     49%|####8     | 5876/12040 [00:39<00:48, 126.08it/s]     49%|####8     | 5897/12040 [00:39<00:42, 143.92it/s]     49%|####9     | 5919/12040 [00:39<00:38, 160.14it/s]     49%|####9     | 5941/12040 [00:39<00:35, 173.09it/s]     50%|####9     | 5963/12040 [00:39<00:33, 182.92it/s]     50%|####9     | 5983/12040 [00:39<00:43, 138.75it/s]     50%|####9     | 6005/12040 [00:39<00:38, 155.19it/s]     50%|#####     | 6027/12040 [00:39<00:35, 168.79it/s]     50%|#####     | 6049/12040 [00:40<00:33, 179.58it/s]     50%|#####     | 6069/12040 [00:40<00:43, 137.62it/s]     51%|#####     | 6091/12040 [00:40<00:38, 154.26it/s]     51%|#####     | 6112/12040 [00:40<00:35, 167.36it/s]     51%|#####     | 6131/12040 [00:40<00:44, 131.46it/s]     51%|#####1    | 6152/12040 [00:40<00:39, 148.14it/s]     51%|#####1    | 6170/12040 [00:41<00:48, 121.19it/s]     51%|#####1    | 6192/12040 [00:41<00:41, 140.36it/s]     52%|#####1    | 6214/12040 [00:41<00:37, 156.77it/s]     52%|#####1    | 6236/12040 [00:41<00:34, 170.64it/s]     52%|#####1    | 6258/12040 [00:41<00:31, 181.48it/s]     52%|#####2    | 6278/12040 [00:41<00:41, 138.35it/s]     52%|#####2    | 6299/12040 [00:41<00:37, 153.97it/s]     52%|#####2    | 6321/12040 [00:41<00:34, 168.06it/s]     53%|#####2    | 6343/12040 [00:41<00:31, 179.35it/s]     53%|#####2    | 6363/12040 [00:42<00:41, 137.36it/s]     53%|#####3    | 6385/12040 [00:42<00:36, 153.91it/s]     53%|#####3    | 6406/12040 [00:42<00:33, 167.11it/s]     53%|#####3    | 6425/12040 [00:42<00:42, 130.97it/s]     54%|#####3    | 6446/12040 [00:42<00:37, 147.82it/s]     54%|#####3    | 6466/12040 [00:42<00:45, 122.53it/s]     54%|#####3    | 6487/12040 [00:43<00:39, 140.22it/s]     54%|#####4    | 6508/12040 [00:43<00:35, 155.86it/s]     54%|#####4    | 6529/12040 [00:43<00:32, 169.00it/s]     54%|#####4    | 6551/12040 [00:43<00:30, 180.59it/s]     55%|#####4    | 6571/12040 [00:43<00:39, 137.50it/s]     55%|#####4    | 6592/12040 [00:43<00:35, 153.23it/s]     55%|#####4    | 6614/12040 [00:43<00:32, 167.42it/s]     55%|#####5    | 6635/12040 [00:43<00:30, 176.66it/s]     55%|#####5    | 6655/12040 [00:44<00:39, 135.94it/s]     55%|#####5    | 6677/12040 [00:44<00:35, 152.82it/s]     56%|#####5    | 6699/12040 [00:44<00:32, 166.78it/s]     56%|#####5    | 6718/12040 [00:44<00:40, 131.27it/s]     56%|#####5    | 6739/12040 [00:44<00:35, 147.98it/s]     56%|#####6    | 6760/12040 [00:44<00:32, 162.24it/s]     56%|#####6    | 6779/12040 [00:45<00:40, 129.07it/s]     56%|#####6    | 6801/12040 [00:45<00:35, 147.10it/s]     57%|#####6    | 6822/12040 [00:45<00:32, 161.57it/s]     57%|#####6    | 6844/12040 [00:45<00:29, 174.98it/s]     57%|#####7    | 6866/12040 [00:45<00:27, 185.13it/s]     57%|#####7    | 6886/12040 [00:45<00:36, 139.85it/s]     57%|#####7    | 6908/12040 [00:45<00:32, 156.74it/s]     58%|#####7    | 6930/12040 [00:45<00:29, 170.46it/s]     58%|#####7    | 6949/12040 [00:46<00:38, 133.32it/s]     58%|#####7    | 6971/12040 [00:46<00:33, 150.80it/s]     58%|#####8    | 6993/12040 [00:46<00:30, 165.52it/s]     58%|#####8    | 7012/12040 [00:46<00:38, 130.83it/s]     58%|#####8    | 7034/12040 [00:46<00:33, 148.49it/s]     59%|#####8    | 7056/12040 [00:46<00:30, 164.25it/s]     59%|#####8    | 7075/12040 [00:46<00:38, 130.54it/s]     59%|#####8    | 7097/12040 [00:47<00:33, 149.28it/s]     59%|#####9    | 7119/12040 [00:47<00:29, 165.03it/s]     59%|#####9    | 7141/12040 [00:47<00:27, 177.60it/s]     59%|#####9    | 7163/12040 [00:47<00:25, 187.73it/s]     60%|#####9    | 7184/12040 [00:47<00:34, 142.39it/s]     60%|#####9    | 7206/12040 [00:47<00:30, 159.11it/s]     60%|######    | 7228/12040 [00:47<00:27, 172.74it/s]     60%|######    | 7248/12040 [00:48<00:35, 135.58it/s]     60%|######    | 7270/12040 [00:48<00:31, 152.85it/s]     61%|######    | 7292/12040 [00:48<00:28, 167.68it/s]     61%|######    | 7311/12040 [00:48<00:35, 132.28it/s]     61%|######    | 7333/12040 [00:48<00:31, 150.23it/s]     61%|######1   | 7355/12040 [00:48<00:28, 165.77it/s]     61%|######1   | 7374/12040 [00:48<00:35, 131.30it/s]     61%|######1   | 7396/12040 [00:48<00:31, 149.72it/s]     62%|######1   | 7418/12040 [00:49<00:27, 165.45it/s]     62%|######1   | 7440/12040 [00:49<00:25, 178.63it/s]     62%|######1   | 7462/12040 [00:49<00:24, 188.73it/s]     62%|######2   | 7483/12040 [00:49<00:31, 143.01it/s]     62%|######2   | 7505/12040 [00:49<00:28, 159.51it/s]     63%|######2   | 7527/12040 [00:49<00:26, 173.25it/s]     63%|######2   | 7547/12040 [00:49<00:33, 135.83it/s]     63%|######2   | 7569/12040 [00:50<00:29, 153.40it/s]     63%|######3   | 7591/12040 [00:50<00:26, 168.25it/s]     63%|######3   | 7610/12040 [00:50<00:33, 132.73it/s]     63%|######3   | 7632/12040 [00:50<00:29, 150.73it/s]     64%|######3   | 7654/12040 [00:50<00:26, 166.04it/s]     64%|######3   | 7673/12040 [00:50<00:33, 131.74it/s]     64%|######3   | 7695/12040 [00:50<00:28, 150.24it/s]     64%|######4   | 7717/12040 [00:51<00:26, 166.25it/s]     64%|######4   | 7739/12040 [00:51<00:24, 178.94it/s]     64%|######4   | 7761/12040 [00:51<00:22, 189.02it/s]     65%|######4   | 7782/12040 [00:51<00:29, 143.00it/s]     65%|######4   | 7804/12040 [00:51<00:26, 159.37it/s]     65%|######5   | 7826/12040 [00:51<00:24, 173.21it/s]     65%|######5   | 7846/12040 [00:51<00:30, 135.65it/s]     65%|######5   | 7867/12040 [00:51<00:27, 150.46it/s]     66%|######5   | 7889/12040 [00:52<00:25, 165.14it/s]     66%|######5   | 7908/12040 [00:52<00:31, 130.76it/s]     66%|######5   | 7930/12040 [00:52<00:27, 148.51it/s]     66%|######6   | 7952/12040 [00:52<00:24, 163.96it/s]     66%|######6   | 7971/12040 [00:52<00:31, 130.28it/s]     66%|######6   | 7993/12040 [00:52<00:27, 148.77it/s]     67%|######6   | 8015/12040 [00:52<00:24, 164.30it/s]     67%|######6   | 8037/12040 [00:53<00:22, 176.99it/s]     67%|######6   | 8059/12040 [00:53<00:21, 186.92it/s]     67%|######7   | 8080/12040 [00:53<00:27, 141.85it/s]     67%|######7   | 8102/12040 [00:53<00:24, 158.38it/s]     67%|######7   | 8124/12040 [00:53<00:22, 171.92it/s]     68%|######7   | 8144/12040 [00:53<00:28, 135.44it/s]     68%|######7   | 8166/12040 [00:53<00:25, 152.40it/s]     68%|######8   | 8188/12040 [00:54<00:23, 167.01it/s]     68%|######8   | 8207/12040 [00:54<00:29, 131.43it/s]     68%|######8   | 8228/12040 [00:54<00:25, 148.02it/s]     69%|######8   | 8250/12040 [00:54<00:23, 163.86it/s]     69%|######8   | 8269/12040 [00:54<00:28, 130.52it/s]     69%|######8   | 8291/12040 [00:54<00:25, 149.16it/s]     69%|######9   | 8313/12040 [00:54<00:22, 164.99it/s]     69%|######9   | 8335/12040 [00:54<00:20, 178.33it/s]     69%|######9   | 8357/12040 [00:55<00:19, 188.09it/s]     70%|######9   | 8378/12040 [00:55<00:25, 141.63it/s]     70%|######9   | 8400/12040 [00:55<00:22, 158.26it/s]     70%|######9   | 8422/12040 [00:55<00:20, 172.37it/s]     70%|#######   | 8443/12040 [00:55<00:26, 136.25it/s]     70%|#######   | 8465/12040 [00:55<00:23, 152.71it/s]     70%|#######   | 8487/12040 [00:55<00:21, 167.12it/s]     71%|#######   | 8506/12040 [00:56<00:26, 132.27it/s]     71%|#######   | 8527/12040 [00:56<00:23, 148.15it/s]     71%|#######1  | 8549/12040 [00:56<00:21, 163.90it/s]     71%|#######1  | 8568/12040 [00:56<00:26, 130.49it/s]     71%|#######1  | 8590/12040 [00:56<00:23, 149.11it/s]     72%|#######1  | 8612/12040 [00:56<00:20, 164.30it/s]     72%|#######1  | 8634/12040 [00:56<00:19, 176.13it/s]     72%|#######1  | 8656/12040 [00:57<00:18, 186.69it/s]     72%|#######2  | 8676/12040 [00:57<00:24, 136.84it/s]     72%|#######2  | 8696/12040 [00:57<00:22, 149.40it/s]     72%|#######2  | 8716/12040 [00:57<00:20, 160.76it/s]     73%|#######2  | 8737/12040 [00:57<00:19, 172.57it/s]     73%|#######2  | 8756/12040 [00:57<00:24, 132.01it/s]     73%|#######2  | 8778/12040 [00:57<00:21, 149.76it/s]     73%|#######3  | 8799/12040 [00:58<00:20, 161.72it/s]     73%|#######3  | 8818/12040 [00:58<00:25, 127.33it/s]     73%|#######3  | 8839/12040 [00:58<00:22, 144.23it/s]     74%|#######3  | 8858/12040 [00:58<00:26, 120.20it/s]     74%|#######3  | 8880/12040 [00:58<00:22, 139.57it/s]     74%|#######3  | 8902/12040 [00:58<00:19, 157.01it/s]     74%|#######4  | 8923/12040 [00:58<00:18, 168.01it/s]     74%|#######4  | 8944/12040 [00:58<00:17, 177.52it/s]     74%|#######4  | 8964/12040 [00:59<00:22, 135.41it/s]     75%|#######4  | 8985/12040 [00:59<00:20, 150.51it/s]     75%|#######4  | 9006/12040 [00:59<00:18, 163.20it/s]     75%|#######4  | 9026/12040 [00:59<00:17, 172.07it/s]     75%|#######5  | 9045/12040 [00:59<00:22, 132.99it/s]     75%|#######5  | 9065/12040 [00:59<00:20, 147.76it/s]     75%|#######5  | 9085/12040 [00:59<00:18, 160.14it/s]     76%|#######5  | 9104/12040 [01:00<00:23, 126.20it/s]     76%|#######5  | 9125/12040 [01:00<00:20, 143.35it/s]     76%|#######5  | 9146/12040 [01:00<00:18, 158.57it/s]     76%|#######6  | 9164/12040 [01:00<00:22, 126.44it/s]     76%|#######6  | 9186/12040 [01:00<00:19, 145.91it/s]     76%|#######6  | 9208/12040 [01:00<00:17, 162.69it/s]     77%|#######6  | 9230/12040 [01:00<00:15, 175.94it/s]     77%|#######6  | 9252/12040 [01:01<00:14, 186.90it/s]     77%|#######7  | 9273/12040 [01:01<00:19, 142.05it/s]     77%|#######7  | 9294/12040 [01:01<00:17, 156.92it/s]     77%|#######7  | 9316/12040 [01:01<00:15, 171.49it/s]     78%|#######7  | 9338/12040 [01:01<00:14, 183.18it/s]     78%|#######7  | 9358/12040 [01:01<00:19, 139.94it/s]     78%|#######7  | 9380/12040 [01:01<00:16, 156.59it/s]     78%|#######8  | 9402/12040 [01:01<00:15, 170.97it/s]     78%|#######8  | 9422/12040 [01:02<00:19, 134.51it/s]     78%|#######8  | 9444/12040 [01:02<00:17, 151.36it/s]     79%|#######8  | 9462/12040 [01:02<00:20, 123.71it/s]     79%|#######8  | 9484/12040 [01:02<00:17, 143.09it/s]     79%|#######8  | 9505/12040 [01:02<00:16, 157.61it/s]     79%|#######9  | 9523/12040 [01:02<00:17, 147.41it/s]     79%|#######9  | 9540/12040 [01:02<00:16, 151.57it/s]     79%|#######9  | 9559/12040 [01:03<00:20, 122.71it/s]     80%|#######9  | 9581/12040 [01:03<00:17, 142.59it/s]     80%|#######9  | 9602/12040 [01:03<00:15, 158.24it/s]     80%|#######9  | 9624/12040 [01:03<00:13, 173.11it/s]     80%|########  | 9643/12040 [01:03<00:17, 133.63it/s]     80%|########  | 9665/12040 [01:03<00:15, 151.54it/s]     80%|########  | 9686/12040 [01:03<00:14, 163.49it/s]     81%|########  | 9705/12040 [01:04<00:18, 126.80it/s]     81%|########  | 9727/12040 [01:04<00:15, 145.83it/s]     81%|########  | 9748/12040 [01:04<00:14, 160.39it/s]     81%|########1 | 9767/12040 [01:04<00:17, 128.65it/s]     81%|########1 | 9789/12040 [01:04<00:15, 147.82it/s]     81%|########1 | 9811/12040 [01:04<00:13, 164.08it/s]     82%|########1 | 9833/12040 [01:04<00:12, 177.54it/s]     82%|########1 | 9855/12040 [01:05<00:11, 187.83it/s]     82%|########2 | 9876/12040 [01:05<00:15, 142.14it/s]     82%|########2 | 9898/12040 [01:05<00:13, 157.82it/s]     82%|########2 | 9920/12040 [01:05<00:12, 171.97it/s]     83%|########2 | 9940/12040 [01:05<00:15, 135.42it/s]     83%|########2 | 9962/12040 [01:05<00:13, 153.01it/s]     83%|########2 | 9984/12040 [01:05<00:12, 167.68it/s]     83%|########3 | 10003/12040 [01:06<00:15, 132.41it/s]     83%|########3 | 10025/12040 [01:06<00:13, 150.46it/s]     83%|########3 | 10047/12040 [01:06<00:12, 165.90it/s]     84%|########3 | 10066/12040 [01:06<00:15, 130.84it/s]     84%|########3 | 10088/12040 [01:06<00:13, 149.31it/s]     84%|########3 | 10110/12040 [01:06<00:11, 165.15it/s]     84%|########4 | 10132/12040 [01:06<00:10, 177.72it/s]     84%|########4 | 10154/12040 [01:06<00:10, 187.85it/s]     85%|########4 | 10175/12040 [01:07<00:13, 142.46it/s]     85%|########4 | 10197/12040 [01:07<00:11, 159.03it/s]     85%|########4 | 10218/12040 [01:07<00:10, 170.94it/s]     85%|########5 | 10238/12040 [01:07<00:13, 134.71it/s]     85%|########5 | 10260/12040 [01:07<00:11, 152.33it/s]     85%|########5 | 10282/12040 [01:07<00:10, 167.11it/s]     86%|########5 | 10301/12040 [01:08<00:13, 131.88it/s]     86%|########5 | 10323/12040 [01:08<00:11, 150.05it/s]     86%|########5 | 10345/12040 [01:08<00:10, 165.49it/s]     86%|########6 | 10364/12040 [01:08<00:12, 130.84it/s]     86%|########6 | 10386/12040 [01:08<00:11, 149.60it/s]     86%|########6 | 10408/12040 [01:08<00:09, 165.14it/s]     87%|########6 | 10430/12040 [01:08<00:09, 178.16it/s]     87%|########6 | 10452/12040 [01:08<00:08, 187.85it/s]     87%|########6 | 10473/12040 [01:09<00:11, 142.33it/s]     87%|########7 | 10494/12040 [01:09<00:09, 157.26it/s]     87%|########7 | 10516/12040 [01:09<00:08, 171.28it/s]     88%|########7 | 10536/12040 [01:09<00:11, 133.79it/s]     88%|########7 | 10557/12040 [01:09<00:09, 149.35it/s]     88%|########7 | 10579/12040 [01:09<00:08, 164.31it/s]     88%|########8 | 10599/12040 [01:09<00:10, 131.12it/s]     88%|########8 | 10620/12040 [01:10<00:09, 147.55it/s]     88%|########8 | 10641/12040 [01:10<00:08, 161.13it/s]     89%|########8 | 10660/12040 [01:10<00:10, 127.83it/s]     89%|########8 | 10682/12040 [01:10<00:09, 146.24it/s]     89%|########8 | 10704/12040 [01:10<00:08, 162.06it/s]     89%|########9 | 10726/12040 [01:10<00:07, 174.95it/s]     89%|########9 | 10748/12040 [01:10<00:06, 184.66it/s]     89%|########9 | 10768/12040 [01:11<00:09, 139.93it/s]     90%|########9 | 10790/12040 [01:11<00:07, 156.33it/s]     90%|########9 | 10812/12040 [01:11<00:07, 170.03it/s]     90%|########9 | 10834/12040 [01:11<00:06, 181.05it/s]     90%|######### | 10854/12040 [01:11<00:08, 138.35it/s]     90%|######### | 10876/12040 [01:11<00:07, 155.29it/s]     91%|######### | 10898/12040 [01:11<00:08, 128.57it/s]     91%|######### | 10920/12040 [01:12<00:07, 145.97it/s]     91%|######### | 10942/12040 [01:12<00:06, 160.93it/s]     91%|#########1| 10961/12040 [01:12<00:08, 129.19it/s]     91%|#########1| 10982/12040 [01:12<00:07, 145.78it/s]     91%|#########1| 11004/12040 [01:12<00:06, 161.86it/s]     92%|#########1| 11026/12040 [01:12<00:05, 175.23it/s]     92%|#########1| 11048/12040 [01:12<00:05, 185.55it/s]     92%|#########1| 11068/12040 [01:13<00:06, 140.79it/s]     92%|#########2| 11090/12040 [01:13<00:06, 157.28it/s]     92%|#########2| 11112/12040 [01:13<00:05, 171.30it/s]     92%|#########2| 11134/12040 [01:13<00:06, 134.06it/s]     93%|#########2| 11153/12040 [01:13<00:06, 145.07it/s]     93%|#########2| 11175/12040 [01:13<00:05, 161.25it/s]     93%|#########2| 11197/12040 [01:13<00:06, 131.27it/s]     93%|#########3| 11218/12040 [01:14<00:05, 147.59it/s]     93%|#########3| 11240/12040 [01:14<00:04, 162.74it/s]     94%|#########3| 11259/12040 [01:14<00:06, 130.08it/s]     94%|#########3| 11281/12040 [01:14<00:05, 148.05it/s]     94%|#########3| 11303/12040 [01:14<00:04, 163.54it/s]     94%|#########4| 11325/12040 [01:14<00:04, 176.53it/s]     94%|#########4| 11347/12040 [01:14<00:03, 186.40it/s]     94%|#########4| 11367/12040 [01:14<00:04, 141.01it/s]     95%|#########4| 11389/12040 [01:15<00:04, 157.40it/s]     95%|#########4| 11411/12040 [01:15<00:03, 170.91it/s]     95%|#########4| 11433/12040 [01:15<00:04, 135.96it/s]     95%|#########5| 11454/12040 [01:15<00:03, 150.81it/s]     95%|#########5| 11476/12040 [01:15<00:03, 165.46it/s]     95%|#########5| 11496/12040 [01:15<00:04, 131.78it/s]     96%|#########5| 11518/12040 [01:15<00:03, 149.14it/s]     96%|#########5| 11540/12040 [01:16<00:03, 164.20it/s]     96%|#########6| 11559/12040 [01:16<00:03, 130.62it/s]     96%|#########6| 11581/12040 [01:16<00:03, 148.87it/s]     96%|#########6| 11603/12040 [01:16<00:02, 164.12it/s]     97%|#########6| 11625/12040 [01:16<00:02, 176.34it/s]     97%|#########6| 11647/12040 [01:16<00:02, 186.41it/s]     97%|#########6| 11667/12040 [01:16<00:02, 141.12it/s]     97%|#########7| 11689/12040 [01:17<00:02, 157.72it/s]     97%|#########7| 11711/12040 [01:17<00:01, 171.50it/s]     97%|#########7| 11732/12040 [01:17<00:02, 135.56it/s]     98%|#########7| 11754/12040 [01:17<00:01, 152.14it/s]     98%|#########7| 11776/12040 [01:17<00:01, 166.55it/s]     98%|#########7| 11795/12040 [01:17<00:01, 132.15it/s]     98%|#########8| 11816/12040 [01:17<00:01, 148.69it/s]     98%|#########8| 11838/12040 [01:18<00:01, 164.18it/s]     98%|#########8| 11857/12040 [01:18<00:01, 129.70it/s]     99%|#########8| 11879/12040 [01:18<00:01, 148.05it/s]     99%|#########8| 11901/12040 [01:18<00:00, 163.72it/s]     99%|#########9| 11923/12040 [01:18<00:00, 176.48it/s]     99%|#########9| 11945/12040 [01:18<00:00, 186.17it/s]     99%|#########9| 11965/12040 [01:18<00:00, 140.76it/s]    100%|#########9| 11987/12040 [01:18<00:00, 157.19it/s]    100%|#########9| 12009/12040 [01:19<00:00, 170.61it/s]    100%|#########9| 12031/12040 [01:19<00:00, 135.46it/s]    100%|##########| 12040/12040 [01:19<00:00, 151.71it/s]
    Hits@1:   0.00 Filtered:   0.00
    Hits@10:  0.01 Filtered:   0.01
    Hits@100: 0.08 Filtered:   0.10
    MR:       1700.11 Filtered: 1644.50
    AUC:      0.72 Filtered:   0.73
    Evaluation finished. Access the results using the "metrics" attribute.





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 18 minutes  40.686 seconds)

**Estimated memory usage:**  1269 MB


.. _sphx_glr_download_examples_elmodels_plot_2_elboxembeddings.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_2_elboxembeddings.py <plot_2_elboxembeddings.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_2_elboxembeddings.ipynb <plot_2_elboxembeddings.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
